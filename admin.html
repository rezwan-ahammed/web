<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SSP Admin | Command Center</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-database-compat.js"></script>
    <style>
        body { font-family: sans-serif; background: #f8fafc; }
        .app-shell { width: 100%; max-width: 480px; min-height: 100vh; background: white; margin: 0 auto; box-shadow: 0 0 50px rgba(0,0,0,0.05); }
        .no-scrollbar::-webkit-scrollbar { display: none; }
    </style>
</head>
<body>
    <div id="root"></div>
    <script type="text/babel">
        const { useState, useEffect, useRef } = React;
        const FIREBASE_CONFIG = {
            apiKey: "AIzaSyAH5NrTOu9uT9_WMBlBhJS4Dqd-qkPEYs8",
            authDomain: "general-57884.firebaseapp.com",
            databaseURL: "https://general-57884-default-rtdb.firebaseio.com",
            projectId: "general-57884",
            appId: "1:5002724584:web:80fde1ae04c6276eb9b55d"
        };
        const DATA_PATH = "artifacts/main-portfolio/public/data";

        function AdminApp() {
            const [profile, setProfile] = useState({ name: "", handle: "", bio: "", avatar: "" });
            const [verifications, setVerifications] = useState([]);
            const [tab, setTab] = useState('profile');
            const rtdb = useRef(null);

            useEffect(() => {
                if (!firebase.apps.length) firebase.initializeApp(FIREBASE_CONFIG);
                rtdb.current = firebase.database();
                firebase.auth().signInAnonymously().then(() => {
                    rtdb.current.ref(`${DATA_PATH}/profile`).on('value', s => s.val() && setProfile(s.val()));
                    rtdb.current.ref(`${DATA_PATH}/verifications`).on('value', snap => {
                        const data = snap.val();
                        if(data) setVerifications(Object.values(data));
                    });
                });
            }, []);

            return (
                <div className="app-shell flex flex-col">
                    <header className="p-6 border-b flex justify-between bg-white sticky top-0">
                        <h1 className="font-black text-xl">SSP Admin</h1>
                        <div className="flex gap-4">
                            <button onClick={() => setTab('profile')} className={tab==='profile'?'font-bold text-blue-600':'text-gray-300'}>Data</button>
                            <button onClick={() => setTab('kyc')} className={tab==='kyc'?'font-bold text-blue-600':'text-gray-300'}>Vault</button>
                        </div>
                    </header>
                    <main className="flex-1 p-6 space-y-8 overflow-y-auto no-scrollbar">
                        {tab === 'profile' && (
                            <div className="space-y-6">
                                <input className="w-full p-4 bg-gray-50 border rounded-2xl font-bold" value={profile.name} onChange={e=>setProfile({...profile, name:e.target.value})} placeholder="Name" />
                                <textarea className="w-full p-4 bg-gray-50 border rounded-2xl h-32" value={profile.bio} onChange={e=>setProfile({...profile, bio:e.target.value})} placeholder="Bio" />
                                <button onClick={()=>rtdb.current.ref(`${DATA_PATH}/profile`).set(profile).then(()=>alert("Saved"))} className="w-full bg-black text-white py-4 rounded-2xl font-black">Sync Profile</button>
                            </div>
                        )}
                        {tab === 'kyc' && (
                            <div className="space-y-6">
                                {verifications.map((v, i) => (
                                    <div key={i} className="p-4 bg-white border rounded-3xl shadow-sm">
                                        <p className="font-bold text-lg mb-2">{v.name}</p>
                                        <div className="grid grid-cols-2 gap-2">
                                            <div>
                                                <p className="text-[10px] font-black uppercase text-gray-400 mb-1">ID Card</p>
                                                <img src={v.idData} className="rounded-xl w-full h-32 object-cover border" />
                                            </div>
                                            <div>
                                                <p className="text-[10px] font-black uppercase text-gray-400 mb-1">Selfie</p>
                                                <img src={v.selfieData} className="rounded-xl w-full h-32 object-cover border" />
                                            </div>
                                        </div>
                                    </div>
                                ))}
                            </div>
                        )}
                    </main>
                </div>
            );
        }
        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<AdminApp />);
    </script>
</body>
</html>
